seed: 1337
run_dir: runs/mnist_usps_skewsubset_200_4000_flip_groupdro
# data
root: ./datasets
num_workers: 4
batch_size: 128
use_skewed_mnist_usps_train_subset: true
mnist_train_size: 200
usps_train_size: 4000
mnist_high_ratio: 0.7  # 70% of MNIST high digits (5-9) in train subset
usps_high_ratio: 0.3   # 70% of USPS low digits (0-4) in train subset (flip)
use_full_pool: true
# groups (MNIST 28x28 and USPS 16x16)
groups:
  - name: mnist28
    type: image
    in_shape: [1, 28, 28]
    encoder: cnn28
  - name: usps16
    type: image
    in_shape: [1, 16, 16]
    encoder: cnn28
# model
latent_dim: 64
num_classes: 10
head_hidden: 0
# anchors
anchor_eps: 1.0e-4
sep_samples_per_class: 16
# GroupDRO enabled
groupdro_enabled: true
groupdro_eta: 0.1
groupdro_update_mode: exp_smooth    # try smoothed MWU
groupdro_gamma: 0.5                 # moderate smoothing
groupdro_objective: weighted        # can switch to 'max' or 'logsumexp'
# debug
debug_one_batch: false
# separation method
sep_method: "classifier"
sep_margin: 2.0
# loss weights
lambda_fit: 1.0e-3
lambda_sep: 1.0e-3
# optim
lr: 0.001
weight_decay: 0.0
epochs: 5
grad_clip: 1.0
# logging
log_interval: 50
save_every: 5
