# Stronger GroupDRO ablation: MNIST=5000, USPS=4000, 15 epochs, warmup, stronger eta/gamma, logsumexp objective

run_name: mnist_usps_skewsubset_5000_4000_flip_15e_groupdro_eta0p50_gamma0p80_warmup3_logsumexp
seed: 1337
root: datasets
run_dir: runs/mnist_usps_skewsubset_5000_4000_flip_15e_groupdro_eta0p50_gamma0p80_warmup3_logsumexp
use_skewed_mnist_usps_train_subset: true
mnist_train_size: 5000
usps_train_size: 4000
mnist_high_ratio: 0.7
usps_high_ratio: 0.3
use_full_pool: true

num_classes: 10
batch_size: 64
num_workers: 0
epochs: 15
lr: 0.001
weight_decay: 0.0
optimizer: adam

# Groups
groups:
  - name: mnist28
    type: image
    in_shape: [1, 28, 28]
    encoder: cnn28
  - name: usps16
    type: image
    in_shape: [1, 16, 16]
    encoder: cnn28

latent_dim: 64
head_hidden: 0
anchor_eps: 0.0001
sep_samples_per_class: 16
sep_method: "classifier"
sep_margin: 2.0
lambda_fit: 0.001
lambda_sep: 0.001

debug_one_batch: false
grad_clip: 1.0
log_interval: 50
save_every: 5

# Stronger GroupDRO with warmup and logsumexp objective
groupdro_enabled: true
groupdro_eta: 0.5
groupdro_gamma: 0.8
groupdro_update_mode: exp_smooth
groupdro_objective: logsumexp
groupdro_warmup_epochs: 3
