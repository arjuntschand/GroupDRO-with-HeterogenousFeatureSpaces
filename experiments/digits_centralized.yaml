seed: 1337
run_dir: runs

# data
dataset: MNIST
root: ./datasets
num_workers: 4
batch_size: 128

# groups & encoders
groups:
  - name: mnist28
    type: image
    in_shape: [1, 28, 28]
    encoder: cnn28
  - name: mnist32
    type: image
    in_shape: [1, 32, 32]
    encoder: cnn32

# model
latent_dim: 64
num_classes: 10
head_hidden: 0   # 0=linear head; >0 => one hidden layer of this size

# anchors
anchor_eps: 1.0e-4
sep_samples_per_class: 16

# GroupDRO options: enable multiplicative weights updates to emphasize high-loss groups
groupdro_enabled: true
groupdro_eta: 0.1

# debug
# when true, run one batch with anomaly detection to surface in-place ops
debug_one_batch: false

# anchor separation method
sep_method: "w2_margin"  # or "classifier"
sep_margin: 2.0  # margin for w2_margin method (ignore if using classifier)

# loss weights
lambda_fit: 1.0e-3
lambda_sep: 1.0e-3

# optim
lr: 1.0e-3
weight_decay: 0.0
epochs: 1
grad_clip: 1.0

# logging
log_interval: 50
save_every: 5
