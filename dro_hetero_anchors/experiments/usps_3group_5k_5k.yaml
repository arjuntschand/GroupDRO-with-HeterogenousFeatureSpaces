seed: 1337
run_dir: runs/usps_3group_5k_5k

# data
root: ./data
num_workers: 4
batch_size: 128

# Use 3-group loaders - USPS MAJORITY
use_skewed_mnist_usps_mnist32: true
mnist28_size: 2500
mnist32_size: 2500
usps_size: 5000
mnist28_majority: [0, 1, 2, 3, 4]   # MNIST28 gets 80% from these classes
mnist32_majority: [0, 1, 2, 3, 4]   # MNIST32 gets 80% from these classes
usps_majority: [5, 6, 7, 8, 9]      # USPS gets 80% from these classes

# groups (for model building)
groups:
  - name: mnist28
    type: image
    in_shape: [1, 28, 28]
    encoder: cnn28
  - name: usps16
    type: image
    in_shape: [1, 16, 16]
    encoder: cnn28
  - name: mnist32
    type: image
    in_shape: [1, 32, 32]
    encoder: cnn32

# model
latent_dim: 64
num_classes: 10
head_hidden: 0

# anchors
anchor_eps: 1.0e-4
sep_samples_per_class: 16

# GroupDRO: disabled for baseline
groupdro_enabled: false
groupdro_eta: 0.1

# debug
debug_one_batch: false

# anchor separation method
sep_method: "classifier"
sep_margin: 2.0

# loss weights
lambda_fit: 1.0e-3
lambda_sep: 1.0e-3

# optim
lr: 1.0e-3
weight_decay: 0.0
epochs: 10
grad_clip: 1.0

# logging
log_interval: 50
save_every: 10
